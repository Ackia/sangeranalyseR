{
    "contents" : "library(sangerseqR)\nlibrary(Biostrings)\n\n# a script to calculate mismatches from ab1 chromatograms, based on a cutoff. Similar to what PHRED does.\n\nprocess_abi_folder <- function(folder, cutoff){\n  abi_files = list.files(folder, pattern = \"\\\\.ab1$\", full.names = T, recursive = T)\n  lapply(abi_files, process_abi_file, cutoff = cutoff)\n}\n\n\nprocess_abi_file <- function(inputfile, cutoff = 0.33){\n  \n  # drop the output in the same folder as the inputfile\n  outputfolder = dirname(inputfile)\n\n  name = basename(inputfile)\n  \n  chromname = paste(name, \"_\", \"chromatogram.pdf\", sep='')\n  tablename = paste(name, \"_\", \"mismatches.csv\", sep='')\n  \n  s = readsangerseq(inputfile)  \n  basecalls = makeBaseCalls(s, ratio = cutoff)\n  chromatogram(basecalls, height = 2, showcalls = 'both', filename = file.path(outputfolder, chromname))\n  \n  # align the primary and secondary base calls\n  pa = pairwiseAlignment(primarySeq(basecalls), secondarySeq(basecalls), type = \"global-local\")\n  \n  # get number of disagreements\n  mismatches = mismatchTable(pa)\n\n  write.csv(mismatches, file = file.path(outputfolder, tablename))\n  \n}\n\n",
    "created" : 1450412930644.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4010490305",
    "id" : "10B9ADCF",
    "lastKnownWriteTime" : 1450412858,
    "path" : "~/Documents/github/hiv/R/mismatches.r",
    "project_path" : "R/mismatches.r",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}